# æœ¬ç§‘æ¯•è®¾ï¼šåŸºäºŽä¸–ç•Œæ¨¡åž‹çš„è‡ªåŠ¨é©¾é©¶åœºæ™¯é¢„æµ‹

ä½¿ç”¨VQ-VAEå’ŒTransformeræž„å»ºä¸–ç•Œæ¨¡åž‹ï¼Œåœ¨é©¾é©¶æ¨¡æ‹Ÿå™¨ä¸­å®žçŽ°åŸºäºŽåŠ¨ä½œçš„æœªæ¥åœºæ™¯é¢„æµ‹ã€‚

## ðŸŽ¯ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®å®žçŽ°äº†ä¸¤ä¸ªå®Œæ•´çš„ä¸–ç•Œæ¨¡åž‹ç³»ç»Ÿï¼š
1. **MetaDriveé¡¹ç›®**ï¼šæ”¯æŒé£Žæ ¼è¿ç§»ï¼ˆå¤œæ™š/é›¾/é›ªï¼‰çš„ä¸–ç•Œæ¨¡åž‹
2. **CARLAé¡¹ç›®**ï¼šå¤§è§„æ¨¡Transformerä¸–ç•Œæ¨¡åž‹ï¼ˆ238Må‚æ•°ï¼‰+ WASDé”®ç›˜æŽ§åˆ¶

**æ ¸å¿ƒæŠ€æœ¯**ï¼šVQ-VAEç¦»æ•£åŒ–åŽ‹ç¼© â†’ Transformeré¢„æµ‹æœªæ¥token â†’ è§£ç ç”Ÿæˆå›¾åƒ

## ðŸ“ é¡¹ç›®ç»“æž„

```
bishe/
â”œâ”€â”€ MetaDrive/              # MetaDriveä¸–ç•Œæ¨¡åž‹ï¼ˆé£Žæ ¼è¿ç§»ï¼‰
â”‚   â”œâ”€â”€ collect_data.py    # æ•°æ®é‡‡é›†
â”‚   â”œâ”€â”€ train/             # è®­ç»ƒè„šæœ¬
â”‚   â”œâ”€â”€ utils/             # å¯è§†åŒ–å·¥å…·
â”‚   â””â”€â”€ web/               # Webæ¼”ç¤º
â”‚
â”œâ”€â”€ carla_project/          # CARLAä¸–ç•Œæ¨¡åž‹ï¼ˆå¤§è§„æ¨¡+WASDæŽ§åˆ¶ï¼‰â­ ä¸»è¦é¡¹ç›®
â”‚   â”œâ”€â”€ models/            # æ¨¡åž‹å®šä¹‰
â”‚   â”œâ”€â”€ train/             # è®­ç»ƒè„šæœ¬
â”‚   â”œâ”€â”€ evaluate/          # è¯„ä¼°ç³»ç»Ÿ
â”‚   â”œâ”€â”€ visualize/         # å¯è§†åŒ–å·¥å…·
â”‚   â”œâ”€â”€ checkpoints/       # âœ… å·²è®­ç»ƒæ¨¡åž‹
â”‚   â”œâ”€â”€ data/              # âœ… æ•°æ®é›†
â”‚   â”œâ”€â”€ docs/              # ðŸ“š å®Œæ•´æ–‡æ¡£
â”‚   â””â”€â”€ script/            # ä¾¿æ·è„šæœ¬
â”‚
â””â”€â”€ README.md              # æœ¬æ–‡æ¡£
```

## ðŸš€ å¿«é€Ÿå¼€å§‹

### CARLAé¡¹ç›®ï¼ˆæŽ¨èï¼‰

**æ‰€æœ‰æ¨¡åž‹å·²è®­ç»ƒå®Œæˆï¼Œå¯ç›´æŽ¥ä½¿ç”¨ï¼**

#### 1. ç”Ÿæˆè§†é¢‘
```bash
cd carla_project

# ä½¿ç”¨WASDæŽ§åˆ¶ç”Ÿæˆè§†é¢‘
cat > my_drive.txt << 'EOF'
W
W
A
D
N
EOF

python visualize/dream.py \
    --vqvae-checkpoint checkpoints/vqvae_v2/best.pth \
    --world-model-checkpoint checkpoints/world_model_v2/best.pth \
    --token-file data/tokens_v2/tokens_actions.npz \
    --action-txt my_drive.txt \
    --output my_video.mp4
```

#### 2. è¯„ä¼°æ¨¡åž‹
```bash
python evaluate/evaluate_world_model.py \
    --vqvae-checkpoint checkpoints/vqvae_v2/best.pth \
    --world-model-checkpoint checkpoints/world_model_v2/best.pth \
    --token-file data/tokens_v2/tokens_actions.npz \
    --output evaluation_results.json
```

#### 3. æŸ¥çœ‹æ–‡æ¡£
```bash
# æŸ¥çœ‹å®Œæ•´æ–‡æ¡£
cat carla_project/docs/README.md

# å¿«é€Ÿå¼€å§‹æŒ‡å—
cat carla_project/docs/QUICKSTART.md

# WASDæŽ§åˆ¶è¯´æ˜Ž
cat carla_project/docs/WASD.md
```

### MetaDriveé¡¹ç›®

#### 1. æ•°æ®é‡‡é›†
```bash
cd MetaDrive
python collect_data.py
```

#### 2. è®­ç»ƒVQ-VAE
```bash
python train/train_vqvae_256.py
```

#### 3. è®­ç»ƒä¸–ç•Œæ¨¡åž‹
```bash
python export_vqvae_tokens.py --checkpoint checkpoints_vqvae_256/vqvae_256_epXX.pth
python train/train_world_model.py
```

#### 4. ç”Ÿæˆè§†é¢‘
```bash
python utils/visualize_dream.py
```

#### 5. Webæ¼”ç¤º
```bash
cd web
python -m http.server 8000
# è®¿é—® http://localhost:8000
```

## ðŸ“Š é¡¹ç›®å¯¹æ¯”

| ç‰¹æ€§ | MetaDriveé¡¹ç›® | CARLAé¡¹ç›® |
|------|--------------|-----------|
| **æ¨¡æ‹Ÿå™¨** | MetaDrive | CARLA 0.9.15 |
| **æ•°æ®è§„æ¨¡** | ä¸­ç­‰ | 10,000å¸§ |
| **æ¨¡åž‹è§„æ¨¡** | å°åž‹ | 238Må‚æ•° |
| **ç‰¹è‰²åŠŸèƒ½** | é£Žæ ¼è¿ç§»ï¼ˆå¤œæ™š/é›¾/é›ªï¼‰ | WASDé”®ç›˜æŽ§åˆ¶ |
| **è®­ç»ƒçŠ¶æ€** | éƒ¨åˆ†å®Œæˆ | âœ… å…¨éƒ¨å®Œæˆ |
| **è¯„ä¼°ç³»ç»Ÿ** | åŸºç¡€ | å®Œæ•´ï¼ˆPSNR/SSIM/ç¨³å®šæ€§ï¼‰ |
| **æ–‡æ¡£** | åŸºç¡€ | å®Œæ•´ |
| **æŽ¨èç”¨é€”** | é£Žæ ¼è¿ç§»å®žéªŒ | ä¸»è¦ç ”ç©¶å’Œè®ºæ–‡ |

## ðŸŽ“ CARLAé¡¹ç›®äº®ç‚¹ï¼ˆæŽ¨èç”¨äºŽæ¯•è®¾ï¼‰

### 1. å®Œæ•´çš„è®­ç»ƒæµç¨‹
- âœ… VQ-VAE v2: Epoch 99, Loss 0.0018
- âœ… World Model (TF): Epoch 149, Loss 0.138
- âœ… World Model (SS): Epoch 2, Loss 0.050

### 2. åˆ›æ–°åŠŸèƒ½
- **WASDé”®ç›˜æŽ§åˆ¶**ï¼šæ”¯æŒ7ä¸ªæŒ‰é”®ï¼ˆW/A/S/D/Q/E/Nï¼‰
- **Scheduled Sampling**ï¼šç¼“è§£è¯¯å·®ç´¯ç§¯
- **å®Œæ•´è¯„ä¼°ç³»ç»Ÿ**ï¼šå•æ­¥é¢„æµ‹ã€è‡ªå›žå½’ç”Ÿæˆã€ç¨³å®šæ€§æŒ‡æ ‡

### 3. å®Œå–„çš„æ–‡æ¡£
- é¡¹ç›®ä¸»æ–‡æ¡£ï¼ˆREADME.mdï¼‰
- å¿«é€Ÿå¼€å§‹æŒ‡å—ï¼ˆQUICKSTART.mdï¼‰
- çŽ¯å¢ƒé…ç½®ï¼ˆSETUP.mdï¼‰
- WASDæŽ§åˆ¶ï¼ˆWASD.mdï¼‰
- å˜æ›´æ—¥å¿—ï¼ˆCHANGELOG.mdï¼‰

### 4. ä¾¿æ·çš„è„šæœ¬
- ä¸€é”®è®­ç»ƒæµç¨‹
- å¿«é€Ÿè¯„ä¼°
- WASDæµ‹è¯•
- å¯¹æ¯”è§†é¢‘ç”Ÿæˆ

## ðŸ’¡ æ¯•è®¾å»ºè®®

### ä¸»è¦ä½¿ç”¨CARLAé¡¹ç›®
1. **æ¨¡åž‹å·²è®­ç»ƒå®Œæˆ**ï¼Œå¯ç›´æŽ¥è¿›è¡Œå®žéªŒ
2. **è¯„ä¼°ç³»ç»Ÿå®Œæ•´**ï¼Œä¾¿äºŽç”Ÿæˆè®ºæ–‡æ•°æ®
3. **æ–‡æ¡£å®Œå–„**ï¼Œä¾¿äºŽæ’°å†™è®ºæ–‡
4. **åˆ›æ–°ç‚¹æ˜Žç¡®**ï¼šWASDæŽ§åˆ¶ã€Scheduled Sampling

### å¯ä»¥åšçš„å·¥ä½œ

#### 1. å®žéªŒä¸Žåˆ†æž
- å¯¹æ¯”Teacher Forcing vs Scheduled Sampling
- åˆ†æžé•¿æœŸç”Ÿæˆçš„ç¨³å®šæ€§ï¼ˆå´©æºƒç‚¹ã€åŠè¡°æœŸï¼‰
- ä¸åŒåŠ¨ä½œåºåˆ—çš„ç”Ÿæˆè´¨é‡å¯¹æ¯”
- WASDæŽ§åˆ¶çš„å®žç”¨æ€§éªŒè¯

#### 2. å¯è§†åŒ–ä¸Žæ¼”ç¤º
- ç”Ÿæˆå¤šç§é©¾é©¶åœºæ™¯è§†é¢‘
- åˆ¶ä½œå¯¹æ¯”è§†é¢‘ï¼ˆçœŸå®ž vs é¢„æµ‹ï¼‰
- å±•ç¤ºWASDäº¤äº’å¼æŽ§åˆ¶
- ç»˜åˆ¶è¯„ä¼°æŒ‡æ ‡å›¾è¡¨

#### 3. è®ºæ–‡æ’°å†™
- ä½¿ç”¨å®Œæ•´çš„è¯„ä¼°æ•°æ®
- å¼•ç”¨CARLAé¡¹ç›®çš„æŠ€æœ¯ç»†èŠ‚
- å±•ç¤ºåˆ›æ–°ç‚¹ï¼ˆWASDæŽ§åˆ¶ã€SSè®­ç»ƒï¼‰
- ä½¿ç”¨ç”Ÿæˆçš„å¯è§†åŒ–ç»“æžœ

#### 4. å¯é€‰ï¼šMetaDriveé£Žæ ¼è¿ç§»
- ä½œä¸ºè¡¥å……å®žéªŒ
- å±•ç¤ºæ¨¡åž‹çš„æ‰©å±•æ€§
- å¯¹æ¯”ä¸åŒæ¨¡æ‹Ÿå™¨çš„æ•ˆæžœ

## ðŸ“š è¯¦ç»†æ–‡æ¡£

### CARLAé¡¹ç›®æ–‡æ¡£
- **ä¸»æ–‡æ¡£**: `carla_project/docs/README.md`
- **å¿«é€Ÿå¼€å§‹**: `carla_project/docs/QUICKSTART.md`
- **çŽ¯å¢ƒé…ç½®**: `carla_project/docs/SETUP.md`
- **WASDæŽ§åˆ¶**: `carla_project/docs/WASD.md`
- **å˜æ›´æ—¥å¿—**: `carla_project/docs/CHANGELOG.md`

### MetaDriveé¡¹ç›®
- å‚è€ƒå„è„šæœ¬ä¸­çš„æ³¨é‡Š
- Webæ¼”ç¤ºï¼š`MetaDrive/web/`

## ðŸ”§ çŽ¯å¢ƒè¦æ±‚

### CARLAé¡¹ç›®
- Ubuntu 20.04/22.04
- NVIDIA GPU (16GB+ æ˜¾å­˜)
- Python 3.8+
- PyTorch 2.0+
- CUDA 11.8+
- CARLA 0.9.15

### MetaDriveé¡¹ç›®
- Python 3.8+
- PyTorch
- MetaDriveæ¨¡æ‹Ÿå™¨

## ðŸ“ˆ é¡¹ç›®çŠ¶æ€

### CARLAé¡¹ç›® âœ…
- [x] æ•°æ®é‡‡é›†ï¼ˆ10,000å¸§ï¼‰
- [x] VQ-VAE v2è®­ç»ƒ
- [x] World Modelè®­ç»ƒï¼ˆTF + SSï¼‰
- [x] è¯„ä¼°ç³»ç»Ÿå®žçŽ°
- [x] WASDæŽ§åˆ¶å®žçŽ°
- [x] æ–‡æ¡£å®Œå–„
- [x] è„šæœ¬å·¥å…·

### MetaDriveé¡¹ç›® ðŸ”„
- [x] åŸºç¡€æµç¨‹
- [x] é£Žæ ¼è¿ç§»
- [x] Webæ¼”ç¤º
- [ ] å®Œæ•´è¯„ä¼°
- [ ] æ–‡æ¡£å®Œå–„

## ðŸŽ¯ æŽ¨èä½¿ç”¨æµç¨‹

1. **ä¸»è¦ä½¿ç”¨CARLAé¡¹ç›®**è¿›è¡Œç ”ç©¶å’Œè®ºæ–‡æ’°å†™
2. **å‚è€ƒMetaDriveé¡¹ç›®**çš„é£Žæ ¼è¿ç§»ä½œä¸ºè¡¥å……
3. é‡ç‚¹å±•ç¤ºCARLAé¡¹ç›®çš„åˆ›æ–°ç‚¹å’Œå®Œæ•´æ€§
4. ä½¿ç”¨CARLAé¡¹ç›®çš„è¯„ä¼°æ•°æ®å’Œå¯è§†åŒ–ç»“æžœ

## ðŸ“ å¼•ç”¨

```
[å¾…è¡¥å……]
```

## ðŸ“„ è®¸å¯

[å¾…è¡¥å……]

---

**æŽ¨è**: ä¼˜å…ˆä½¿ç”¨ `carla_project/`ï¼Œæ¨¡åž‹å·²è®­ç»ƒå®Œæˆï¼Œæ–‡æ¡£å®Œå–„ï¼Œé€‚åˆæ¯•è®¾ï¼

**æœ€åŽæ›´æ–°**: 2026-01-13
